# Session Timeout Security Vulnerabilities

**Priority:** High  
**Severity:** Critical  
**Reporter:** Iveta Kuklov√°  
**Date Reported:** January 20, 2026  
**Environment:** Development

---

## Summary
After automatic session timeout (30 minutes of inactivity), users are not redirected to the login page and can still modify data (create/update/delete bank accounts and execute transactions) without valid authentication. Changes are persisted in the database despite the expired session, and sensitive user data remains visible on screen.

---

## Environment
- **Application:** CzechiBank (educational banking application)
- **Browser:** Safari Version 18.6 (18621.3.11.19.1, 18621)
- **Device:** MacBook Pro
- **OS:** macOS Ventura 13.7.8
- **Test Date:** January 20, 2026

---

## Description
While the automatic session timeout feature correctly expires the user session after 30 minutes of inactivity (indicated by the disappearance of the avatar icon and appearance of "Sign in" button), the application fails to properly handle the expired session. This creates two significant security and user experience issues.

### Primary Issue (Critical Severity)
Users can perform data modification operations after session expiration. All operations including creating, renaming, and deleting bank accounts, as well as executing financial transactions, are successfully processed and persisted to the database. Users receive success confirmations for each operation, and changes remain after re-login.

### Secondary Issue (High Severity)
Users are not automatically redirected to the login page after session timeout. Instead, they remain on the current page where sensitive information continues to be displayed. On the Profile page, user data including name, email, and partial API key remain visible. On the Bank Accounts page, all accounts with balances and details are still displayed. On the Transactions page, transaction history and account information remain accessible. This creates potential information disclosure risk, especially on shared devices.

### Security Risk
- Users can modify sensitive financial data without valid authentication
- Potential for unauthorized transactions after session expiration
- Database integrity compromised by operations performed with expired sessions
- Sensitive user data exposed on unattended devices
- Other users sharing the device can view private information
- User might not realize their session has expired

### Affected Features
1. **Bank Account Management** - Create, rename, and delete accounts after session expiration
2. **Transaction Processing** - Execute money transfers without valid authentication
3. **Profile Page** - View user data and partial API key after session expiration
4. **All Authenticated Pages** - No redirect to login, data remains visible

### Technical Observations

**Frontend Session Validation Inconsistency:**

Components that CHECK session validity:
- Avatar display (correctly hidden after timeout)
- API key generation (disabled after timeout)
- Avatar change functionality (disabled after timeout)

Components that DO NOT check session validity:
- Bank accounts operations (create, update, delete)
- Transaction execution
- User data display on Profile page
- Page access control

**Browser DevTools Findings:**
- After session timeout, session cookie is removed from browser
- Despite missing session cookie, POST requests for transactions return HTTP 200 OK
- API accepts and processes requests without valid session validation
- No automatic redirect mechanism triggered

**Session State Indicators:**

What correctly indicates expired session:
- Avatar icon removal
- "Sign in" button appearance
- Disabled API key generation
- Disabled avatar change functionality

What incorrectly suggests active session:
- Presence on authenticated pages
- Visible user data
- Accessible UI elements
- Successfully processed data modifications
- No explicit session expiration message

**Navigation Behavior:**
- Clicking CzechiBank logo successfully redirects to login page
- Using browser "Back" button returns user to page with expired session, data remains visible
- This creates inconsistent and potentially confusing user experience

---

## Steps to Reproduce

### Scenario 1: Bank Account Operations After Session Timeout

**Preconditions:**
- User is logged in with valid credentials
- User has at least one bank account

**Steps:**
1. Log in to the application
2. Navigate to the Bank Accounts page (main dashboard)
3. Wait 30 minutes without performing any actions
4. Observe: Avatar icon disappears, "Sign in" button appears (session expired)
5. Attempt to rename an existing bank account
6. Attempt to create a new bank account
7. Attempt to delete an account
8. Log in again with the same credentials
9. Verify the changes made in steps 5-7

### Scenario 2: Transaction Execution After Session Timeout

**Preconditions:**
- User is logged in with valid credentials
- User has at least one bank account with sufficient balance

**Steps:**
1. Log in to the application
2. Navigate to the Transactions page by clicking on a bank account
3. Wait 30 minutes without performing any actions
4. Observe: Avatar icon disappears, "Sign in" button appears (session expired)
5. Select a recipient from the dropdown
6. Enter an amount in the "Amount" field
7. Click the "Transfer" button
8. Observe the success message and GIF animation
9. Log in again and verify transaction in history

### Scenario 3: Profile Page Access After Session Timeout

**Preconditions:**
- User is logged in with valid credentials

**Steps:**
1. Log in to the application
2. Navigate to Profile page (click avatar/profile icon)
3. Wait 30 minutes without performing any actions
4. Observe: Avatar icon disappears, "Sign in" button appears (session expired)
5. Observe user data still visible on the Profile page
6. Click CzechiBank logo to redirect to login
7. Use browser "Back" button to return to Profile page
8. Observe user data remains visible

---

## Expected vs Actual Behavior

**Expected Behavior:**
After session timeout, the user should be immediately redirected to the login page across all pages. No data modification operations should be allowed, and any attempts should be rejected with a "Session expired" error message. All sensitive data should be cleared from the display, and no user information should remain visible. No changes should be persisted to the database without valid authentication.

**Actual Behavior:**
After session timeout, the avatar icon disappears and the "Sign in" button becomes visible, but users remain on the current page with all data still visible. All data modification operations including creating, renaming, and deleting bank accounts, as well as executing financial transactions, are successfully processed and persisted to the database. Users receive success confirmations for each operation. On the Profile page, user data including name, email, and partial API key remain fully visible. On the Bank Accounts page, all accounts with names, numbers, balances, and currency information are still displayed. On the Transactions page, transaction history, account details, and balances remain accessible. Some functionality is correctly disabled (API key generation, avatar change), but critical operations remain functional. No redirect to login occurs, and no session expiration message is shown.

---

## Related Issues
This bug appears to be related to previously reported session management issues showing similar patterns of UI state not matching backend validation behavior.


## Related Issues
This bug appears to be related to previously reported session management issues showing similar patterns of UI state not matching backend validation behavior.
